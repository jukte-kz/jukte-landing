(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[219],{5332:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[slug]",function(){return a(3364)}])},121:function(e,t,a){"use strict";a.d(t,{Z:function(){return c}});var s=a(5893),l=a(5675),n=a.n(l),r=a(1163);function c(e){var t=e.removeUrl,a=e.text,l=(0,r.useRouter)(),c=function(){l.push(t)};return(0,s.jsxs)("div",{className:"flex items-center justify-between header-main w-full border-b-2 px-4 py-2",children:[(0,s.jsxs)("button",{onClick:c,className:"flex items-center",children:[(0,s.jsx)(n(),{width:24,height:24,src:"/assets/icon/left-arrow.svg",alt:""}),(0,s.jsx)("p",{className:"ml-4",children:a})]}),(0,s.jsx)(n(),{width:80,height:40,src:"/assets/image/logo.svg"})]})}},3364:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return P},transport:function(){return S}});var s=a(4924),l=a(6042),n=a(9396),r=a(603),c=a(5893),i=a(121),o=a(9395),u=a(6627),$=a.n(u),d=a(7294),h=a(1955),p=a(9669),m=a.n(p),x=a(129),b=a.n(x),f=a(9198),g=a.n(f);a(944);var v=a(3424),j=a(4298),_=a.n(j),k=a(1163),N=a(381),y=a.n(N),w=a(5165),C=a(1806),S=[{value:1,label:"Фура",price:400},{value:2,label:"Самосвал",price:27},{value:3,label:"Тралл",price:1e3},{value:4,label:"Рефрижератор",price:500},{value:5,label:"Изотерм",price:400},{value:6,label:"Бортовой",price:400},{value:7,label:"Крытый",price:400},{value:8,label:"Открытый",price:400},{value:9,label:"Тент",price:400},{value:8,label:"Зерновоз",price:27},{value:9,label:"Газель",price:180}];function P(){var e,t=(0,d.useState)(""),a=t[0],u=t[1],p=(0,d.useState)(""),x=p[0],f=p[1],j=(0,d.useState)(""),N=j[0],P=j[1],Z=(0,d.useState)(""),F=Z[0],z=Z[1],E=(0,d.useState)(""),M=E[0],T=E[1],q=(0,d.useState)(""),R=q[0],D=q[1],L=(0,d.useState)([null,null]),U=L[0],A=L[1],B=(0,r.Z)(U,2),O=B[0],X=B[1],I=(0,d.useState)(""),Y=I[0],G=I[1],H=(0,d.useState)(""),J=H[0],K=H[1],Q=(0,d.useState)(""),V=Q[0],W=Q[1],ee=(0,d.useState)(!1),et=(ee[0],ee[1]),ea=(0,d.useState)(""),es=ea[0],el=ea[1],en=(0,d.useState)(""),er=en[0],ec=en[1],ei=(0,d.useState)(""),eo=ei[0],eu=ei[1],e$=(0,d.useState)(!1),ed=e$[0],eh=e$[1],ep=(0,d.useState)(!1),em=ep[0],ex=ep[1],eb=(0,d.useState)(!1),ef=eb[0],eg=eb[1],ev=(0,d.useState)(null),ej=ev[0],e_=ev[1],e0=(0,d.useState)(null),ek=e0[0],eN=e0[1],e2=(0,d.useState)(null),ey=e2[0],e3=e2[1],e8=(0,d.useState)(!1),ew=(e8[0],e8[1]),e7=(0,d.useState)(Array),e1=e7[0],e4=e7[1],eC=(0,d.useState)(!1),e6=eC[0],eS=eC[1],eP=(0,d.useRef)(),e5=(0,k.useRouter)(),eZ=(0,d.useCallback)(function(e){P(e.target.value)},[]),eF=(0,d.useCallback)(function(e){u(e.target.value)},[]),ez=(0,d.useCallback)(function(e){f(e.target.value)},[]),eE=(0,d.useCallback)(function(e){D(e.target.value.split(" ")[2])}),eM=(0,d.useCallback)(function(e){T(e.target.value.split(" ")[2]),parseFloat(e.target.value)>20?et(!0):et(!1)});(0,d.useEffect)(function(){e6||(m()({method:"get",url:"https://api.jukte.kz/orders/archive",headers:{"content-type":"application/x-www-form-urlencoded;charset=utf-8",token:h.Z.get("accessToken")}}).then(function(e){e.data.data&&e4(e.data.data.orders),eS(!0)}),m()({method:"get",url:"https://api.jukte.kz/user/info",headers:{"content-type":"application/x-www-form-urlencoded;charset=utf-8",token:h.Z.get("accessToken")}}).then(function(e){e.data&&(eS(!0),e3(e.data.role),W(e.data.transport.type))}))}),(0,d.useEffect)(function(){parseInt(M)>22?"Тралл"!==V&&"Самосвал"!==V&&ew(!0):ew(!1)}),(0,d.useEffect)(function(){eh(F.length>0&&M.length>0),ex(F.length>0&&M.length>0&&O&&N.length>0&&a.length&&parseInt(es.replace(/\s/g,""))>0)}),(0,d.useEffect)(function(){eN(e5.asPath.replace("/","")),ek&&e_(e1.find(function(e){return e._id===ek}))});var eT=function(e){A(e)},eq=function(e){eu(e.label)},eR=function(){m()({method:"put",url:"https://api.jukte.kz/orders/".concat(ek),data:b().stringify({product:a,description:N,price:parseInt(es.replace(/\s/g,"")),weight:parseInt(M.replace(/\s/g,"")),date:"".concat(y()(O).format("L")," - ").concat(y()(X).format("L")),type:V,from:Y,to:J,loadType:eo,cubProduct:R,logPrice:parseInt(er.replace(/\s/g,"")),distance:parseInt(F.replace(/\s/g,""))}),headers:{"content-type":"application/x-www-form-urlencoded;charset=utf-8",token:h.Z.get("accessToken")}}).then(function(e){200===e.status&&eg(!0)})},eD=function(){var e=parseInt(F.replace(/\s/g,"")),t=S.filter(function(e){return e.label===V})[0].price;if(27===t){var a=t*parseFloat(M)*e-t*parseFloat(M)*e*.1;el(a+" ₸"),ec(.1*a+" ₸")}else{var s=e*t-e*t*.1;el(s+" ₸"),ec(.1*s+" ₸")}},eL=function(){eg(!1),e5.push("/home")};return(0,c.jsxs)("div",{children:[(0,c.jsx)(i.Z,{removeUrl:"/home",text:"На главную"}),(0,c.jsxs)("div",{className:"settings-main py-6 px-4",children:[(0,c.jsx)("h1",{children:"Обновить заявку"}),(0,c.jsx)("hr",{className:"mt-4"}),(0,c.jsx)("form",{className:"flex flex-col mt-4 login-form",children:(0,c.jsxs)("div",{className:"mb-auto",children:[(0,c.jsxs)("div",{className:"w-full mb-4 relative",style:{height:"400px"},children:[(0,c.jsx)("div",{id:"map",ref:eP}),(0,c.jsx)(_(),{id:"yandex-maps",src:"https://api-maps.yandex.ru/2.1/?apikey=0fb09044-5132-48a3-8653-02425b40b298&lang=ru_RU",onLoad:function(){var e=function(){var e=new ymaps.Map(eP.current,{center:[51.128207,71.43042],zoom:9,controls:["routePanelControl"]}).controls.get("routePanelControl");e.routePanel.options.set({types:{auto:!0,pedestrian:!1}}),e.routePanel.getRouteAsync().then(function(t){t.model.events.add("requestsuccess",function(){var a=t.getActiveRoute();a&&(P(a.properties.get("duration").text),z(a.properties.get("distance").text),G(e.routePanel.state.get("from")),K(e.routePanel.state.get("to")))})},function(e){console.log(e)})};ymaps.ready(e)}})]}),"driver"!==ey&&(0,c.jsxs)("div",{className:"input-container",children:[(0,c.jsx)("div",{className:"mb-2 block",children:(0,c.jsx)(o.__,{htmlFor:"product",value:"Наименование товара"})}),ej&&(0,c.jsx)(o.oi,{id:"product",type:"text",placeholder:ej.product,required:!0,sizing:"lg",value:a,onChange:eF})]}),(0,c.jsxs)("div",{className:"input-container",children:[(0,c.jsx)("div",{className:"mb-2 block",children:(0,c.jsx)(o.__,{htmlFor:"desc",value:"Детали перевозки"})}),ej&&(0,c.jsx)(o.gx,{value:x,onChange:ez,placeholder:ej.detail})]}),(0,c.jsxs)("div",{className:"input-container",children:[(0,c.jsx)("div",{className:"mb-2 block",children:(0,c.jsx)(o.__,{htmlFor:"surname",value:"Выберите дату отправления"})}),ej&&(0,c.jsx)(g(),(e={selected:O,dateFormat:"dd.MM.yyyy",onChange:eT,startDate:O,endDate:X,placeholderText:ej.date,dateFormatCalendar:"MMMM",className:"block w-full border focus\\:ring-blue-500:focus disabled:cursor-not-allowed disabled:opacity-50 bg-gray-50 border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500 rounded-lg sm:text-md p-4",yearDropdownItemNumber:100,scrollableYearDropdown:!0,minDate:new Date,selectsRange:!0,isClearable:!0},(0,s.Z)(e,"onChange",function(e){A(e)}),(0,s.Z)(e,"locale",C.Z),e))]}),"logistician"===ey&&(0,c.jsxs)("div",{className:"input-container",children:[(0,c.jsx)("div",{className:"mb-2 block",children:(0,c.jsx)(o.__,{htmlFor:"transport",value:"Выберите тип транспорта"})}),ej&&(0,c.jsx)(v.ZP,{className:"react-select block w-full border focus\\:ring-blue-500:focus disabled:cursor-not-allowed disabled:opacity-50 bg-gray-50 border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500 rounded-lg sm:text-md p-2",classNamePrefix:"name",placeholder:ej.type,options:S,onChange:eq,isSearchable:!1})]}),(0,c.jsxs)("div",{className:"input-container",children:[(0,c.jsx)("div",{className:"mb-2 block",children:(0,c.jsx)(o.__,{htmlFor:"transport",value:"Выберите тип погрузки"})}),ej&&(0,c.jsx)(v.ZP,{className:"react-select block w-full border focus\\:ring-blue-500:focus disabled:cursor-not-allowed disabled:opacity-50 bg-gray-50 border-gray-300 text-gray-900 focus:border-blue-500 focus:ring-blue-500 rounded-lg sm:text-md p-2",classNamePrefix:"name",placeholder:ej.loadType,options:w.t,onChange:eq,isSearchable:!1})]}),(0,c.jsxs)("div",{className:"input-container",children:[(0,c.jsx)("div",{className:"mb-2 block",children:(0,c.jsx)(o.__,{htmlFor:"weight",value:"Вес груза"})}),ej&&(0,c.jsx)($(),{value:M,maskChar:null,onChange:eM,mask:"тонн | 99",children:function(e){return(0,c.jsx)(o.oi,(0,n.Z)((0,l.Z)({},e),{id:"distance",type:"tel",placeholder:"тонн | "+ej.weight,required:!0,sizing:"lg"}))}})]}),(0,c.jsxs)("div",{className:"input-container",children:[(0,c.jsx)("div",{className:"mb-2 block",children:(0,c.jsx)(o.__,{htmlFor:"cubProduct",value:"Кубометр груза"})}),ej&&(0,c.jsx)($(),{value:R,maskChar:null,onChange:eE,mask:"м3 | 999",children:function(e){return(0,c.jsx)(o.oi,(0,n.Z)((0,l.Z)({},e),{onChange:eE,value:R,id:"distance",type:"tel",placeholder:"м3 | "+ej.cubProduct,sizing:"lg"}))}})]}),(0,c.jsxs)("div",{className:"input-container",children:[(0,c.jsx)("div",{className:"mb-2 block",children:(0,c.jsx)(o.__,{htmlFor:"distance",value:"Расстояние"})}),ej&&(0,c.jsx)(o.oi,{disabled:!0,id:"distance",type:"tel",value:F,placeholder:ej.distance+" км",required:!0,sizing:"lg"})]}),(0,c.jsxs)("div",{className:"input-container",children:[(0,c.jsx)("div",{className:"mb-2 block",children:(0,c.jsx)(o.__,{htmlFor:"desc",value:"Время в пути"})}),ej&&(0,c.jsx)(o.oi,{onChange:eZ,value:N,disabled:!0,id:"desc",type:"text",placeholder:ej.description,required:!0,sizing:"lg"})]}),(0,c.jsxs)("div",{className:"input-container",children:[(0,c.jsx)("div",{className:"mb-2 block",children:(0,c.jsx)(o.__,{htmlFor:"price",value:"Цена"})}),ej&&(0,c.jsx)(o.oi,{disabled:!0,id:"price",value:es,placeholder:ej.price+" ₸",required:!0,sizing:"lg"})]}),(0,c.jsxs)("div",{className:"input-container",children:[(0,c.jsx)("div",{className:"mb-2 block",children:(0,c.jsx)(o.__,{htmlFor:"price",value:"Цена за услуги логиста"})}),ej&&(0,c.jsx)(o.oi,{disabled:!0,id:"price",value:er,placeholder:ej.logPrice+" ₸",required:!0,sizing:"lg"})]})]})}),(0,c.jsx)("button",{type:"button",disabled:!ed,className:"flex items-center settings-button px-4 mt-4",onClick:eD,children:(0,c.jsx)("p",{className:"w-full",children:"Посчиатать"})}),(0,c.jsx)("button",{type:"button",disabled:!em,className:"flex items-center settings-button px-4 mt-4",onClick:eR,children:(0,c.jsx)("p",{className:"w-full",children:"Обновить заявку"})})]}),(0,c.jsxs)(o.u_,{show:ef,position:"center",children:[(0,c.jsx)(o.u_.Body,{children:(0,c.jsxs)("div",{className:"w-full success-container",children:[(0,c.jsx)("p",{className:"text-center",children:"Заявка успешно обновлена!"}),(0,c.jsx)("div",{className:"success-animation mt-6",children:(0,c.jsxs)("svg",{className:"checkmark",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 52 52",children:[(0,c.jsx)("circle",{className:"checkmark__circle",cx:"26",cy:"26",r:"25",fill:"none"}),(0,c.jsx)("path",{className:"checkmark__check",fill:"none",d:"M14.1 27.2l7.1 7.2 16.7-16.8"})]})})]})}),(0,c.jsx)(o.u_.Footer,{children:(0,c.jsx)("button",{className:"w-full redirect-button",onClick:eL,children:"Перейти в меню"})})]})]})}},5165:function(e,t,a){"use strict";a.d(t,{t:function(){return s}});var s=[{value:1,label:"Задний"},{value:2,label:"Боковой"},{value:3,label:"Верхний"},{value:4,label:"Любой"},]},4654:function(){}},function(e){e.O(0,[556,885,873,656,129,646,588,774,888,179],function(){return e(e.s=5332)}),_N_E=e.O()}]);
//# sourceMappingURL=[slug]-3319e7521788d53a.js.map